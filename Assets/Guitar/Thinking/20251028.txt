스테이터스 시스템을 건드리지 않은 게 꽤 오래 전 일이다
많은 변화가 있는 도중 이건 굳건히 서 있었는데 사실 선 채로 죽어서 그런 것 같다
이건 옛날부터 스테이터스를 여기저기 뿌리는 게 귀찮아 그냥 둔 거였던 것으로 기억
그런데 언제까지나 이걸 그대로 둘 수는 없기에 바로 고치기로 하자

일단 Container - Bridge 시스템이 꽤 좋다는 것을 알았다
원래 Event 기반으로 접근하려 했는데 그건 약간 옛날 Scratch로 게임 만들던 감성이다
버프가 생기거나 제거된다 => 알린다 => 제거한다 순서로 접근하려던 시도였지만 이젠 상황이 좀 다름
우리에게 Ticker가 있으니 이 Ticker를 사용해 좀 더 정밀하게 버프를 다룰 수 있다

그런데 Ticker로 duration을 제어하는 방법은 대략 두 가지가 있다
첫 번째는 durationTick을 저장하는 방법, 그리고 두 번째는 expiredTick을 저장하는 방법이다
첫 번째 방법은 Ticker에서 내려오는 틱을 세어 durationTick 이상 세었다면 버프를 제거한다
이 방법은 가장 떠올리기 쉽지만 Scheduling이 문제다
effects 객체가 자체적으로 틱을 세어 알아서 죽거나, effects 관리자가 필요한 부분이다

두 번째 방법은 각 effect가 expiredTick을 저장하고 지정된 Tick에 도달하면 전부 제거하는 방법이다
이건 매 틱 expiredTick에 도달한 effect가 있나 검사하면 되기 때문에 관리 자체는 쉽다
그런데 매 틱 검사하기에 약간 부하가 생기고, 오버플로에 정말 취약하다
버프가 한둘이면 괜찮지만 많으면 많을수록 검사량이 늘어난다
사실 시간복잡도가 O(n)이라고 하지만 버프가 5000개 걸릴 일도 없어 딱히 문제는 없다
진짜 문제는 아래 오버플로 문제이다

예를 들어 게임이 65530틱 진행되었다고 하자(실제 일어나리라고 생각하지는 않는다)
그런데 120틱 유지되는 버프가 걸렸다
ushort에서는 65530 + 120 != 65650이다
오버플로가 발생하기 때문에 아마 115가 될 것이다(114?)
그럼 이미 expiredTick에 도달한 지 한참 되었으므로 이 버프는 걸리자마자 제거된다

그렇다면 어떻게 하라는 건가? 애초에 오버플로가 안 나게 게임을 만들면 된다
ushort의 max value는 65535인데, 60Hz로 세어보면 대략 1092초이고 이는 약 18분 12초 가량이다
이 게임의 장르와 템포를 고려하면 한 판을 18분 동안 한다는 건 비정상적이다
그런데 사람 일은 또 모르는 법, 스나이퍼 들고 짤짤이만 뒤지게 치면서 18분 넘길 수도 있다
그러면 전장을 축소하는 게 아마 방법이 될 것 같다
직접적으로 축소하는 건 전략의 가짓수를 심각하게 축소시키기에 하면 안 된다
PUBG의 자기장처럼 전장의 크기를 활용하되 리스크를 짊어지게 하는 게 유효한 것 같다

여기서 재밌는 생각이 들었다
이 게임은 그냥 싸우는 게임이 아니라 마치 WWE 같은 거다
즉 싸우는 걸 하나의 쇼로 생각하면 된다
자기장은 스포트라이트의 크기를 줄이는 것으로 조절한다
이러면 "스포트라이트를 벗어난 싸움꾼은 주목 대신 야유를 받아 약해집니다, 심지어 싸움을 포기하고 싶을 수도 있습니다" 
라고 해서 납득 가능하게 만들 수 있다

또 타임아웃 시스템도 이렇게 하면 충분히 사용 가능하다
"너무 오래 싸워 관중이 지쳤습니다, 그냥 승패를 겨루고 다음 경기를 보자고 합니다"
라고 하며 타임아웃을 결정하면 된다
타임아웃 시간은 대략 15분으로 두는 게 나을 것 같다
65535는 대략 18분 12초이긴 한데 18분은 너무 애매하지

그런데 이거 그냥 인게임 효과만 걸어버리면 좀 납득이 어렵다
유저가 "스포트라이트로 들어가야 한다" 라는 걸 인식하게 만들어야 잘 만든 시스템
그러므로 스포트라이트에서 벗어나 야유 중첩을 받을수록 더 야유가 커지고 격해지게 만든다
처음에는 "뭐야?", "왜 사라져?" 처럼 반응하지만 갈수록 "아, 뭐 해 계속?" 처럼 반응하다 결국에는 그냥 욕지거리를 하게 만드는 거다
여기서 야유 중첩이 쌓이고 관중들이 막말을 뱉을수록 화면에 울렁거리는 듯한 필터를 넣을 수도 있겠다

나왔다가 다시 들어가면 야유 중첩이 더 많이 쌓이고 반응도 "또 저 지랄이네" 처럼 나오게 만든다
약간 야구장 같은 스포츠 구장에 가면 흔히 있는 그런 목소리가 나오게 해서 분위기를 살릴 수 있을 것이다
물론 이런 충격에 약한 유저도 존재하는 만큼 처음에 "설정할까요? 이런 분위기가 싫으시면 권장하지 않습니다." 처럼 선택지를 준다

반대로 게임 잘 하고 있으면 계속 호응이 있는 거지
마치 프로레슬링 보는 것처럼 강한 기술 맞추면 환호하고 반대로 맞으면 놀라거나 걱정한다
킬을 따면 박수갈채와 환호
사실 띠껍게 싸우는 게 원래 정석이고, 진짜 전쟁터에서는 이런 일방적 타격과 기만 전술이 가장 좋다
그런데 사람들은 정정당당하게 벌이는 혈투를 사랑하지 띠껍고 꼴받게 싸우는 걸 별로 좋아하지 않는다
게임에서도 그런 감정은 전혀 바뀌지 않기에 그런 사람들의 입장을 대변하는 장치로 볼 수도 있겠다

그럼 그 야유 중첩은 어떤 기능을 하는가?
받는 피해 증가와 주는 피해 감소를 건다
그리고 체력에 따라 야유 중첩이 충분히 쌓였을 경우에는
"사랑받지 못하는 싸움꾼은 링 위에 있을 수 없습니다. 당신의 싸움꾼은 싸우고 싶지 않아졌습니다"
처럼 강제로 패배시키는 거다

아마 특성으로 이걸 막게 만들 수는 있겠다
예를 들자면 이런 특성이 나오겠지
괴짜: 야유 중첩이 더 적게 쌓입니다. 야유로 인해 패배하지 않습니다.
아니면 이런 특성?
악당: 야유 중첩이 이제 받는 피해량과 가하는 피해량을 동시에 증가시킵니다. 야유로 인해 패배하지 않습니다.

악당은 뭔가 레인저나 스나이퍼가 시간 끌다가 악당으로 헛짓거리 할 것 같음
왜 헛짓거리? 야유 중첩은 무한이다
중첩에 제한을 걸어버리면 막을 수 있고, 아마 관중이 야유하다 지쳐서 그냥 본다고 생각하면 괜찮을 듯
아무리 지랄해도 안 통하면 어느새 잠잠해지기 마련이니까
단 최대치는 체력이 100%여도 야유로 패배하게끔(악당이 아닐 경우) 설정할 필요가 있음
괴짜는 밸런스 측면에서 아주 안전하기는 한데 자아 특성으로 갈 거라 처형인, 도전자, 전쟁광 삼신기에 비할 수 없을 것 같음
처도전 삼신기 제쳐도 도박꾼 못 이길 듯ㅋㅋ 

그림자 영역 쓰는 놈은 야유 면역을 달아줘야 하나
스포트라이트 바깥은 어두운 곳이라 그게 맞는 것 